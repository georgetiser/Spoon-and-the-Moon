-- Code created by Kwik - Copyright: kwiksher.com -- Version: 2.4.6 module(..., package.seeall) function new() 	_G.kwk_ShowDebugOutput = 1	_G.kwk_DebugBuildVersion = "15-07-14/T"	-- The following sets the development-label settings	-- (bottom of this page)	if _G.kwk_ShowDebugOutput then InitializeDebugText() end	local FileForIntroMovie = "movie_part1_introLnS.mp4"	local menuGroup = display.newGroup() 	local dispose 	local _W = display.contentWidth; 	local _H = display.contentHeight; 	-- Audio callings 	local HeyDiddle64 = audio.loadStream(audioDir .. "heydiddle64.mp3", system.ResourceDirectory)   local drawScreen = function()    --DEBUGTEXT    if _G.kwk_ShowDebugOutput then      print("PageDisplay called.")      devtxt1 = display.newText(_G.kwk_DebugText1_t, _G.kwk_DebugText1_x, _G.kwk_DebugText1_y, _G.kwk_DebugText1_w, _G.kwk_DebugText1_h, _G.kwk_DebugText1_f, _G.kwk_DebugText1_s); devtxt1:setFillColor(_G.kwk_DebugText1_cr,_G.kwk_DebugText1_cg,_G.kwk_DebugText1_cb); devtxt1.alpha = 1      devtxt2 = display.newText(_G.kwk_DebugText2_t, _G.kwk_DebugText2_x, _G.kwk_DebugText2_y, _G.kwk_DebugText2_w, _G.kwk_DebugText2_h, _G.kwk_DebugText2_f, _G.kwk_DebugText2_s); devtxt2:setFillColor(_G.kwk_DebugText2_cr,_G.kwk_DebugText2_cg,_G.kwk_DebugText2_cb); devtxt2.alpha = 1      devtxt3 = display.newText(_G.kwk_DebugText3_t, _G.kwk_DebugText3_x, _G.kwk_DebugText3_y, _G.kwk_DebugText3_w, _G.kwk_DebugText3_h, _G.kwk_DebugText3_f, _G.kwk_DebugText3_s); devtxt3:setFillColor(_G.kwk_DebugText3_cr,_G.kwk_DebugText3_cg,_G.kwk_DebugText3_cb); devtxt3.alpha = 1    end--if    --DEBUGTEXTEND		print("----------------"); print(""); print("New Page") 		print("The current page is: " .. _G.kwk_currentPage) 		if (kBookmark == 1) then 			local path = system.pathForFile( "book.txt", system.DocumentsDirectory ) 			local file = io.open( path, "w+" ) 			file:write ( _G.kwk_currentPage.."\n1" ) 			io.close( file ) 		end 		math.randomseed(os.time()) 		if (kAutoPlay > 0) then 			local function act_autoPlay(event) 				if(_G.kwk_currentPage < _G.kwk_lastPage) then 					if(kBidi == false) then							dispose()						_G.kwk_currentPage = _G.kwk_currentPage + 1						print("Act Autoplay (F): Go to page " .. _G.kwk_currentPage)						director:changeScene( "page_" .. _G.kwk_currentPage, "moveFromRight" ) 					else							dispose()						_G.kwk_currentPage = _G.kwk_currentPage - 1						print("Act Autoplay (T): Go to page " .. _G.kwk_currentPage)						director:changeScene( "page_" .. _G.kwk_currentPage, "moveFromLeft" ) 					end--if					end--if 			end--function 			timerStash.timer_AP = timer.performWithDelay( kAutoPlay*1000, act_autoPlay, 1 ) 		end--if 		-- Button names 		local Cright		-- Layer names 		local BG			local kwkBforward			-- (TOP) External code will render here 		-- BG positioning 		BG = display.newImageRect(imgDir .. "p1_bg.png", 768, 1024 ); 		BG.x = 384; BG.y = 512; BG.alpha = 1; BG.oldAlpha = 1 		BG.oriX = BG.x; BG.oriY = BG.y 		BG.name = "BG" 		menuGroup:insert(1,BG); menuGroup.BG = BG 		-- kwkBforward positioning 		kwkBforward = display.newImageRect(imgDir .. "kwkBforward.png", 111, 87 ); 		kwkBforward.x = 475; kwkBforward.y = 971; kwkBforward.alpha = 1; kwkBforward.oldAlpha = 1 		kwkBforward.oriX = kwkBforward.x; kwkBforward.oriY = kwkBforward.y 		kwkBforward.name = "kwkBforward" 		menuGroup:insert(kwkBforward); menuGroup.kwkBforward = kwkBforward 		local function onkwkBforwardEvent(event) 			Cright(kwkBforward) 			return true 		end 		kwkBforward:addEventListener("tap", onkwkBforwardEvent ) 		local function onintroshowEvent(event) 			but_introshow_998(introshow) 			return true 		end 		function Cright(self) 			local myClosure_switch = function() 				dispose()				_G.kwk_currentPage = _G.kwk_currentPage + 1				print("Cright: Play movie " .. _G.kwk_currentPage)				media.playVideo( FileForIntroMovie, system.ResourceDirectory, false ) 				print("Cright: Go forward to page " .. _G.kwk_currentPage)				director:changeScene( "page_" .. _G.kwk_currentPage, "fade" ) 			end 			timerStash.newTimer_976 = timer.performWithDelay(0, myClosure_switch, 1) 		end 		-- swipe this page with spacer of 120 in normal direction 		Gesture.activate( BG, {swipeLength=120} ) 		local function pageSwap(event ) 			print("PageSwap: current page is " .. _G.kwk_currentPage)			if event.phase == "ended" and event.direction ~= nil then					local wPage = _G.kwk_currentPage					local direction					if event.direction == "left" and kBidi == false then						print("F. Event direction says: go left.")					wPage = _G.kwk_currentPage + 1						if wPage > _G.kwk_lastPage then						print("Page number too high: " .. wPage)						print("Redirecting to last page.")						wPage = _G.kwk_lastPage					end						direction = "moveFromRight"					elseif event.direction == "left" and kBidi == true then						print("T. Event direction says: go left.")					wPage = _G.kwk_currentPage - 1						if wPage < 1 then					print("Page number too low: " .. wPage)					print("Redirecting to menu page.")					wPage = _G.kwk_menuPage					end						direction = "moveFromLeft"					elseif event.direction == "right" and kBidi == true then						print("T. Event direction says: go right.")					wPage = _G.kwk_currentPage + 1						if wPage > _G.kwk_lastPage then					print("Page number too high: " .. wPage)					print("Redirecting to last page.")					wPage = _G.kwk_lastPage					end						direction = "moveFromRight"					elseif event.direction == "right" and kBidi == false then						print("F. Event direction says: go right.")					_G.kwk_currentPage = _G.kwk_currentPage - 1						if _G.kwk_currentPage < 1 then					print("Page number too low: " .. _G.kwk_currentPage)					wPage = _G.kwk_menuPage					end						direction = "moveFromLeft"					end					print("From " .. _G.kwk_currentPage .. " to " .. wPage)				if wPage ~= _G.kwk_currentPage then dispose(); 						dispose()						print("Changing current page to " .. wPage .. ".")						_G.kwk_currentPage = wPage						director:changeScene("page_".._G.kwk_currentPage, direction) 				end 			end			end 		BG:addEventListener( Gesture.SWIPE_EVENT, pageSwap ) 			dispose = function(event) 				cancelAllTimers(); cancelAllTransitions() 				audio.stop(32); audio.dispose(HeyDiddle64); HeyDiddle64 = nil 				BG:removeEventListener( Gesture.SWIPE_EVENT, pageSwap ); Gesture.deactivate(BG) 			end 			-- (BOTTOM) External code will render here 	end 	drawScreen() 	local myClosure_HeyDiddle64 = function() 		--[[ commenting out the silencer		if _G.kwk_ShowDebugOutput then			audio.setVolume(0, { channel=32} ); 		end--if		]]		audio.play(HeyDiddle64, {	channel=32, loops=0, fadein=500 } ) 	end--function heydiddle	timerStash.newTimer_872 = timer.performWithDelay(0, myClosure_HeyDiddle64, 1) 	return menuGroup end function InitializeDebugText()	_G.kwk_BuildDate = string.sub(_G.kwk_DebugBuildVersion, 4, 5) .. "/" .. string.sub(_G.kwk_DebugBuildVersion, 7, 8) .. "/20" .. string.sub(_G.kwk_DebugBuildVersion, 1, 2)	_G.kwk_DebugText1_x = 0	_G.kwk_DebugText1_y = -24	_G.kwk_DebugText1_w = 760	_G.kwk_DebugText1_h = 200	_G.kwk_DebugText1_f = "Arbutus Slab"	_G.kwk_DebugText1_s = 48	_G.kwk_DebugText1_cr = 255	_G.kwk_DebugText1_cg = 255	_G.kwk_DebugText1_cb = 0	_G.kwk_DebugText1_t = "DEVELOPMENT VERSION " .. string.sub(_G.kwk_DebugBuildVersion, string.len(_G.kwk_DebugBuildVersion))	_G.kwk_DebugText2_x = 20	_G.kwk_DebugText2_y = 1025	_G.kwk_DebugText2_w = 600	_G.kwk_DebugText2_h = 200	_G.kwk_DebugText2_f = "Arbutus Slab"	_G.kwk_DebugText2_s = 24	_G.kwk_DebugText2_cr = 255	_G.kwk_DebugText2_cg = 255	_G.kwk_DebugText2_cb = 0	_G.kwk_DebugText2_t = "Development Version v." .. _G.kwk_DebugBuildVersion	_G.kwk_DebugText3_x = 600	_G.kwk_DebugText3_y = 1025	_G.kwk_DebugText3_w = 200	_G.kwk_DebugText3_h = 100	_G.kwk_DebugText3_f = "Arbutus Slab"	_G.kwk_DebugText3_s = 24	_G.kwk_DebugText3_cr = 255	_G.kwk_DebugText3_cg = 255	_G.kwk_DebugText3_cb = 0	_G.kwk_DebugText3_t = string.sub(_G.kwk_DebugBuildVersion, 4, 5) .. "/" .. string.sub(_G.kwk_DebugBuildVersion, 7, 8) .. "/20" .. string.sub(_G.kwk_DebugBuildVersion, 1, 2)end